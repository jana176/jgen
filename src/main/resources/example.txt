package nl.tele2.fez.retailstores.model;

import static javax.persistence.FetchType.LAZY;

import java.io.Serializable;
import java.time.LocalDateTime;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.ManyToOne;
import javax.persistence.OneToOne;
import javax.persistence.PostLoad;
import javax.persistence.PostUpdate;
import javax.persistence.PrePersist;
import javax.persistence.Table;
import javax.persistence.Transient;
import javax.validation.Valid;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;

import org.hibernate.validator.constraints.NotBlank;

import com.fasterxml.jackson.annotation.JsonGetter;
import com.fasterxml.jackson.annotation.JsonIdentityInfo;
import com.fasterxml.jackson.annotation.JsonIdentityReference;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonInclude.Include;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonProperty.Access;
import com.fasterxml.jackson.annotation.JsonView;
import com.fasterxml.jackson.annotation.ObjectIdGenerators;

import io.swagger.annotations.ApiModel;
import io.swagger.annotations.ApiModelProperty;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;

import nl.tele2.fez.retailstores.configuration.EntityIdResolver;
import nl.tele2.fez.retailstores.model.enumeration.SalesChannelType;
import nl.tele2.fez.retailstores.model.views.View;

/**
 * Entity bean maps retail_stores table
 *
 * @author Uros Gmizic (uros.gmizic@tele2.com)
 * @since 8 Jun 2017
 */
@Entity
@Table(name = "retail_stores")
@NoArgsConstructor
@AllArgsConstructor
@Data
public class RetailStore implements Serializable {

    private static final long serialVersionUID = 7330690319893044076L;

    @ApiModelProperty(required = true, notes = "This value is auto-generated, therefore it should not be present in the request (it will be ignored)")
    @Id
    @GeneratedValue
    private Long id;

    @JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = "id", resolver = EntityIdResolver.class, scope = RetailCompany.class)
    @JsonIdentityReference(alwaysAsId = true)
    @JsonProperty("retailCompanyId")
    @ManyToOne(fetch = LAZY)
    @NotNull
    private RetailCompany retailCompany;

    @Column(name = "RETAIL_STORE_ID", nullable = false)
    private String retailStoreId;

    @Column(name = "NAME", nullable = false)
    @Size(min = 1, max = 100)
    @NotBlank
    private String name;

    @JsonProperty(access = Access.WRITE_ONLY)
    @Column(name = "CREATED", nullable = false)
    private LocalDateTime created;

    @OneToOne(mappedBy = "retailStore", cascade = CascadeType.ALL)
    @Valid
    private StoreLocationDetails storeLocationDetails;

}
